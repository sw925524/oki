<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Okinawa Travel App</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        [v-cloak] { display: none; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; margin: 0; }
        .oki-header { background: linear-gradient(135deg, #0284c7 0%, #0369a1 100%); padding: 40px 20px; text-align: center; color: white; border-bottom-left-radius: 30px; border-bottom-right-radius: 30px; }
        .day-tab { min-width: 60px; height: 80px; transition: all 0.3s; }
        .active-day { background-color: #0369a1 !important; color: white !important; transform: translateY(-5px); }
        .card { background: white; border-radius: 16px; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); margin-bottom: 12px; }
        .fab { position: fixed; right: 20px; bottom: 100px; width: 60px; height: 60px; background: #0369a1; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); cursor: pointer; border: none; z-index: 50; }
    </style>
</head>
<body>
    <div id="app" v-cloak>
        <div class="oki-header">
            <h1 class="text-2xl font-black">æ²–ç¹©å¤æ—¥ç´€è¡Œ</h1>
            <p class="text-sm opacity-80 mt-1">2025.04.14 - 04.18</p>
        </div>

        <div class="px-4 -mt-6">
            <div class="flex overflow-x-auto space-x-3 pb-4 no-scrollbar">
                <div v-for="day in tripDays" :key="day.date" 
                     @click="currentDate = day.date"
                     :class="['day-tab flex flex-col items-center justify-center rounded-2xl bg-white text-slate-400 shadow-sm cursor-pointer', { 'active-day shadow-lg': currentDate === day.date }]">
                    <span class="text-xs font-bold">{{ day.week }}</span>
                    <span class="text-xl font-black">{{ day.dayNum }}</span>
                </div>
            </div>

            <div class="mt-4">
                <div v-if="itineraries[currentDate].length === 0" class="text-center py-20 text-slate-400">
                    é€™å¤©é‚„æ²’æœ‰è¡Œç¨‹ï¼ŒæŒ‰å³ä¸‹è§’æ–°å¢ ğŸ“
                </div>
                
                <div v-for="(item, index) in itineraries[currentDate]" :key="index" 
                     class="card p-4 flex items-center gap-4" @click="openEdit(index)">
                    <div class="text-2xl">{{ getIcon(item.category) }}</div>
                    <div class="flex-1">
                        <div class="flex justify-between items-center">
                            <h3 class="font-bold text-slate-700">{{ item.name }}</h3>
                            <span class="text-xs font-bold text-sky-600">{{ item.time }}</span>
                        </div>
                        <p class="text-xs text-slate-400 mt-1">{{ item.note || 'é»æ“ŠæŸ¥çœ‹è©³æƒ…' }}</p>
                    </div>
                </div>
            </div>
        </div>

        <div class="fixed bottom-0 left-0 right-0 h-20 bg-white border-t flex justify-around items-center z-40 px-10">
            <div class="flex flex-col items-center text-sky-600">
                <span class="text-xl">ğŸ“</span><span class="text-[10px] font-bold">è¡Œç¨‹</span>
            </div>
            <div @click="resetData" class="flex flex-col items-center text-slate-300">
                <span class="text-xl">ğŸ”„</span><span class="text-[10px] font-bold">é‡ç½®</span>
            </div>
        </div>

        <button class="fab" @click="openAdd">+</button>

        <div v-if="showModal" class="fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-6 backdrop-blur-sm">
            <div class="bg-white w-full rounded-3xl p-6 shadow-2xl">
                <h3 class="text-xl font-black mb-4">{{ isEdit ? 'ä¿®æ”¹' : 'æ–°å¢' }}è¡Œç¨‹</h3>
                <div class="space-y-4">
                    <input v-model="form.name" placeholder="åœ°é»åç¨±" class="w-full bg-slate-100 p-4 rounded-xl outline-none">
                    <div class="flex gap-2">
                        <select v-model="form.category" class="flex-1 bg-slate-100 p-4 rounded-xl outline-none">
                            <option>æ™¯é»</option><option>ç¾é£Ÿ</option><option>ä½å®¿</option><option>äº¤é€š</option>
                        </select>
                        <input type="time" v-model="form.time" class="flex-1 bg-slate-100 p-4 rounded-xl outline-none">
                    </div>
                    <textarea v-model="form.note" placeholder="å‚™è¨»" class="w-full bg-slate-100 p-4 rounded-xl outline-none h-20"></textarea>
                </div>
                <div class="flex gap-3 mt-6">
                    <button @click="showModal = false" class="flex-1 py-4 bg-slate-100 rounded-2xl font-bold">å–æ¶ˆ</button>
                    <button @click="save" class="flex-1 py-4 bg-sky-600 text-white rounded-2xl font-bold">å„²å­˜</button>
                </div>
                <button v-if="isEdit" @click="deleteItem" class="w-full mt-3 py-2 text-red-500 text-sm font-bold">åˆªé™¤æ­¤è¡Œç¨‹</button>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted } = Vue;

        createApp({
            setup() {
                const currentDate = ref('2025-04-14');
                const showModal = ref(false);
                const isEdit = ref(false);
                const currentIdx = ref(null);
                
                const tripDays = [
                    { date: '2025-04-14', week: 'SUN', dayNum: '14' },
                    { date: '2025-04-15', week: 'MON', dayNum: '15' },
                    { date: '2025-04-16', week: 'TUE', dayNum: '16' },
                    { date: '2025-04-17', week: 'WED', dayNum: '17' },
                    { date: '2025-04-18', week: 'THU', dayNum: '18' }
                ];

                const itineraries = ref({
                    '2025-04-14': [], '2025-04-15': [], '2025-04-16': [], '2025-04-17': [], '2025-04-18': []
                });

                const form = ref({ name: '', category: 'æ™¯é»', time: '10:00', note: '' });

                const loadData = () => {
                    const saved = localStorage.getItem('OKI_V1_REBOOT');
                    if (saved) itineraries.value = JSON.parse(saved);
                };

                const save = () => {
                    if (!form.value.name) return alert("è«‹è¼¸å…¥åœ°é»åç¨±");
                    if (isEdit.value) {
                        itineraries.value[currentDate.value][currentIdx.value] = { ...form.value };
                    } else {
                        itineraries.value[currentDate.value].push({ ...form.value });
                    }
                    localStorage.setItem('OKI_V1_REBOOT', JSON.stringify(itineraries.value));
                    showModal.value = false;
                };

                const openAdd = () => {
                    isEdit.value = false;
                    form.value = { name: '', category: 'æ™¯é»', time: '12:00', note: '' };
                    showModal.value = true;
                };

                const openEdit = (index) => {
                    isEdit.value = true;
                    currentIdx.value = index;
                    form.value = { ...itineraries.value[currentDate.value][index] };
                    showModal.value = true;
                };

                const deleteItem = () => {
                    itineraries.value[currentDate.value].splice(currentIdx.value, 1);
                    localStorage.setItem('OKI_V1_REBOOT', JSON.stringify(itineraries.value));
                    showModal.value = false;
                };

                const resetData = () => {
                    if (confirm("ç¢ºå®šè¦æ¸…ç©ºæ‰€æœ‰è³‡æ–™å—ï¼Ÿ")) {
                        localStorage.removeItem('OKI_V1_REBOOT');
                        location.reload();
                    }
                };

                const getIcon = (cat) => {
                    const map = { 'æ™¯é»': 'ğŸï¸', 'ç¾é£Ÿ': 'ğŸœ', 'ä½å®¿': 'ğŸ¨', 'äº¤é€š': 'ğŸš—' };
                    return map[cat] || 'ğŸ“';
                };

                onMounted(loadData);

                return {
                    tripDays, currentDate, itineraries, showModal, form, isEdit,
                    save, openAdd, openEdit, deleteItem, getIcon, resetData
                };
            }
        }).mount('#app');
    </script>
</body>
</html>
