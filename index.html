<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Okinawa Summer - ä¿®å¾©ç‰ˆ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.3.4/vue.global.prod.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Vue.Draggable/4.1.0/vuedraggable.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --oki-blue: #0088CC; --bg: #F8FBFE; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--bg); touch-action: manipulation; }
        .header-gradient { background: linear-gradient(135deg, #00AEEF 0%, #0088CC 100%); height: 160px; position: relative; }
        .header-curve { position: absolute; bottom: -1px; width: 100%; height: 35px; background: var(--bg); border-radius: 35px 35px 0 0; }
        .glass-card { background: white; border-radius: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.03); border: 1px solid #f0f4f8; margin-bottom: 12px; }
        .nav-active { background: #0088CC !important; color: white !important; }
        .floating-btn { position: fixed; right: 20px; bottom: 100px; width: 56px; height: 56px; background: #0088CC; border-radius: 28px; color: white; display: flex; align-items: center; justify-content: center; font-size: 28px; z-index: 50; box-shadow: 0 4px 15px rgba(0,136,204,0.3); }
    </style>
</head>
<body class="pb-24">
    <div id="app" v-cloak>
        <div v-if="error" class="bg-red-500 text-white text-xs p-2 text-center fixed top-0 w-full z-[200]">
            è³‡æ–™è®€å–ç•°å¸¸ï¼Œå·²å˜—è©¦ä¿®å¾©ã€‚ <button @click="resetApp" class="underline font-bold">å¼·åˆ¶é‡ç½®</button>
        </div>

        <header class="header-gradient flex flex-col items-center justify-center text-white">
            <h1 class="text-xl font-black tracking-widest">æ²–ç¹©å¤æ—¥ç´€è¡Œ</h1>
            <div class="header-curve"></div>
        </header>

        <main class="px-4 -mt-2 relative z-10">
            <div class="flex overflow-x-auto space-x-3 py-2 mb-4 no-scrollbar">
                <button v-for="day in tripDays" :key="day.date" 
                    @click="currentDate = day.date"
                    :class="['flex-shrink-0 w-14 h-18 rounded-2xl flex flex-col items-center justify-center bg-white text-slate-400 shadow-sm', { 'nav-active': currentDate === day.date }]">
                    <span class="text-[9px] font-bold">{{ day.week }}</span>
                    <span class="text-lg font-black">{{ day.dayNum }}</span>
                </button>
            </div>

            <draggable v-model="itineraries[currentDate]" item-key="id" @end="saveData" handle=".handle">
                <template #item="{element, index}">
                    <div class="glass-card p-4 flex gap-3 items-center handle" @click="openEdit(element, index)">
                        <span class="text-xl">{{ getIcon(element.category) }}</span>
                        <div class="flex-1">
                            <div class="flex justify-between">
                                <span class="font-bold text-slate-700">{{ element.name }}</span>
                                <span class="text-[10px] text-blue-400 font-bold">{{ element.time }}</span>
                            </div>
                        </div>
                    </div>
                </template>
            </draggable>
        </main>

        <button @click="openAdd" class="floating-btn">+</button>

        <nav class="fixed bottom-0 left-0 right-0 h-16 bg-white border-t flex justify-around items-center z-50">
            <button @click="activeTab = 'itinerary'" class="flex flex-col items-center text-blue-500">
                <span class="text-lg">ğŸ“</span><span class="text-[10px] font-bold">è¡Œç¨‹</span>
            </button>
            <button @click="resetApp" class="flex flex-col items-center text-slate-300">
                <span class="text-lg">ğŸ”„</span><span class="text-[10px] font-bold">é‡ç½®</span>
            </button>
        </nav>

        <div v-if="modal" class="fixed inset-0 z-[100] bg-black/50 flex items-center justify-center p-6">
            <div class="bg-white w-full rounded-3xl p-6">
                <h3 class="font-bold mb-4">{{ isEdit ? 'ç·¨è¼¯' : 'æ–°å¢' }}è¡Œç¨‹</h3>
                <input v-model="form.name" placeholder="åç¨±" class="w-full bg-slate-100 p-3 rounded-xl mb-3 outline-none">
                <div class="flex gap-2 mb-3">
                    <select v-model="form.category" class="bg-slate-100 p-3 rounded-xl flex-1">
                        <option>æ™¯é»</option><option>ç¾é£Ÿ</option><option>ä½å®¿</option>
                    </select>
                    <input type="time" v-model="form.time" class="bg-slate-100 p-3 rounded-xl flex-1">
                </div>
                <div class="flex gap-2">
                    <button @click="modal = false" class="flex-1 py-3 bg-slate-100 rounded-xl font-bold">å–æ¶ˆ</button>
                    <button @click="save" class="flex-1 py-3 bg-blue-500 text-white rounded-xl font-bold">å„²å­˜</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp, ref, onMounted } = Vue;

        createApp({
            setup() {
                const currentDate = ref('2025-04-14');
                const itineraries = ref({'2025-04-14':[], '2025-04-15':[], '2025-04-16':[], '2025-04-17':[], '2025-04-18':[]});
                const modal = ref(false);
                const isEdit = ref(false);
                const editIdx = ref(null);
                const error = ref(false);
                const form = ref({ name: '', category: 'æ™¯é»', time: '10:00' });

                const tripDays = [
                    { date: '2025-04-14', week: 'SUN', dayNum: '14' },
                    { date: '2025-04-15', week: 'MON', dayNum: '15' },
                    { date: '2025-04-16', week: 'TUE', dayNum: '16' },
                    { date: '2025-04-17', week: 'WED', dayNum: '17' },
                    { date: '2025-04-18', week: 'THU', dayNum: '18' }
                ];

                const saveData = () => {
                    try {
                        localStorage.setItem('OKI_FINAL_DATA', JSON.stringify(itineraries.value));
                    } catch(e) { error.value = true; }
                };

                const loadData = () => {
                    const data = localStorage.getItem('OKI_FINAL_DATA');
                    if (data) {
                        try {
                            const parsed = JSON.parse(data);
                            // ç¢ºä¿çµæ§‹æ­£ç¢º
                            tripDays.forEach(d => { if(!parsed[d.date]) parsed[d.date] = []; });
                            itineraries.value = parsed;
                        } catch(e) { 
                            console.error("Data Corrupted");
                            error.value = true;
                        }
                    }
                };

                const openAdd = () => {
                    isEdit.value = false;
                    form.value = { name: '', category: 'æ™¯é»', time: '10:00' };
                    modal.value = true;
                };

                const openEdit = (item, idx) => {
                    isEdit.value = true;
                    editIdx.value = idx;
                    form.value = { ...item };
                    modal.value = true;
                };

                const save = () => {
                    if(!form.value.name) return;
                    if(isEdit.value) itineraries.value[currentDate.value][editIdx.value] = { ...form.value };
                    else itineraries.value[currentDate.value].push({ ...form.value, id: Date.now() });
                    saveData();
                    modal.value = false;
                };

                const resetApp = () => {
                    if(confirm("ç¢ºå®šè¦æ¸…é™¤æ‰€æœ‰è³‡æ–™ä¸¦é‡ç½®å—ï¼Ÿ")) {
                        localStorage.removeItem('OKI_FINAL_DATA');
                        location.reload();
                    }
                };

                const getIcon = (cat) => {
                    const icons = { 'æ™¯é»':'ğŸï¸', 'ç¾é£Ÿ':'ğŸœ', 'ä½å®¿':'ğŸ¨' };
                    return icons[cat] || 'ğŸ“';
                };

                onMounted(loadData);

                return {
                    currentDate, itineraries, modal, isEdit, form, error,
                    tripDays, openAdd, openEdit, save, resetApp, getIcon
                };
            }
        }).component('draggable', window.vuedraggable).mount('#app');
    </script>
</body>
</html>
</html>
