<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Okinawa 2026 Final Precision</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        [v-cloak] { display: none; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f1f5f9; padding-bottom: 120px; }
        .header-bg {
            background: linear-gradient(rgba(0,0,0,0.5), rgba(0,0,0,0.2)), url('https://images.unsplash.com/photo-1559128010-7c1ad6e1b6a5?q=80&w=1000');
            background-size: cover; background-position: center; height: 160px;
            display: flex; flex-direction: column; justify-content: center; align-items: center; color: white;
            border-bottom-left-radius: 30px; border-bottom-right-radius: 30px; position: relative;
        }
        .tab-nav { position: fixed; bottom: 0; left: 0; right: 0; height: 85px; background: white; border-top: 1px solid #e2e8f0; display: flex; justify-content: space-around; align-items: center; z-index: 100; }
        .tab-btn { flex: 1; display: flex; flex-direction: column; align-items: center; color: #94a3b8; font-size: 11px; font-weight: bold; }
        .tab-active { color: #0369a1 !important; }
        .cat-tag { padding: 8px 16px; background: white; border-radius: 20px; font-size: 13px; font-weight: bold; color: #64748b; border: 1px solid #e2e8f0; white-space: nowrap; }
        .cat-tag-active { background: #0369a1; color: white; border-color: #0369a1; }
        .card { background: white; border-radius: 20px; padding: 16px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); margin-bottom: 12px; }
        .modal-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.6); backdrop-blur: 4px; z-index: 200; display: flex; align-items: flex-end; }
        .modal-content { background: white; width: 100%; border-top-left-radius: 30px; border-top-right-radius: 30px; padding: 24px; max-height: 90vh; overflow-y: auto; }
        input, select, textarea { width: 100%; background: #f8fafc; border: 1px solid #e2e8f0; padding: 12px; border-radius: 12px; font-weight: bold; margin-top: 4px; outline: none; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
    </style>
</head>
<body>
    <div id="app" v-cloak>
        <header class="header-bg">
            <h1 class="text-2xl font-black tracking-widest text-white">æ²–ç¹©å¤æ—¥ç´€è¡Œ</h1>
            <div class="absolute bottom-4 right-6 bg-white/20 backdrop-blur-md px-3 py-1 rounded-full border border-white/30 flex items-center gap-2">
                <span class="text-sm">â˜€ï¸</span><span class="text-xs font-black text-white">28Â°C NAHA</span>
            </div>
        </header>

        <main class="px-4 mt-6">
            <div v-if="activeTab === 'plan'">
                <div class="flex gap-2 mb-6">
                    <button v-for="day in tripDays" @click="currentDate = day.date"
                        :class="['flex-1 h-16 rounded-2xl flex flex-col items-center justify-center transition-all', currentDate === day.date ? 'bg-sky-800 text-white shadow-lg' : 'bg-white text-slate-400 shadow-sm']">
                        <span class="text-[9px] font-bold">{{ day.week }}</span>
                        <span class="text-lg font-black">{{ day.dayNum }}</span>
                    </button>
                </div>
                
                <div v-for="(item, index) in itineraries[currentDate]" :key="index" class="card" @click="openEditPlan(item, index)">
                    <div class="flex gap-4">
                        <div class="text-3xl">{{ getIcon(item.category) }}</div>
                        <div class="flex-1">
                            <div class="flex justify-between items-start">
                                <h3 class="font-black text-slate-700 leading-tight">{{ item.name }}</h3>
                                <span class="text-[10px] font-black text-sky-600 bg-sky-50 px-2 py-0.5 rounded whitespace-nowrap ml-2">{{ item.time }}</span>
                            </div>
                            <div class="mt-2 space-y-1">
                                <p v-if="item.openTime" class="text-[10px] text-slate-500">ğŸ•’ è³‡è¨Š: {{ item.openTime }}</p>
                                <p v-if="item.ticket" class="text-[10px] text-orange-600 font-bold">ğŸ« é–€ç¥¨: {{ item.ticket }}</p>
                                <p class="text-[11px] text-slate-400 mt-1 leading-relaxed whitespace-pre-line">{{ item.note }}</p>
                            </div>
                        </div>
                    </div>
                </div>
                <button @click="openAddPlan" class="fixed right-6 bottom-24 w-14 h-14 bg-sky-800 text-white rounded-full shadow-xl text-3xl font-light z-50">+</button>
            </div>

            <div v-if="activeTab === 'food'">
                <div class="sticky top-0 bg-[#f1f5f9] pt-2 pb-4 z-10">
                    <h2 class="text-xl font-black text-slate-800 mb-4">ğŸ± ç¾é£Ÿæ¸…å–®</h2>
                    <div class="flex overflow-x-auto gap-2 no-scrollbar px-1">
                        <button v-for="c in categories" @click="selectedCat = c" 
                            :class="['cat-tag', selectedCat === c ? 'cat-tag-active' : '']">{{ c }}</button>
                    </div>
                </div>
                <div class="space-y-4 pb-10">
                    <div v-for="f in filteredFood" class="card">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="font-black text-slate-700">{{ f.name }}</h3>
                            <span class="text-[10px] bg-slate-100 text-slate-400 px-2 py-1 rounded font-bold">{{ f.area }}</span>
                        </div>
                        <p class="text-[11px] text-slate-500 mb-4 leading-relaxed">{{ f.desc }}</p>
                        <div class="flex gap-2">
                            <button @click="goMapSearch(f.name)" class="flex-1 py-2.5 bg-slate-50 rounded-xl text-[11px] font-bold text-slate-600 border border-slate-100">åœ°åœ–æœå°‹</button>
                            <button @click="addFoodToPlan(f)" class="flex-1 py-2.5 bg-sky-800 text-white rounded-xl text-[11px] font-bold shadow-md">åŠ å…¥è¡Œç¨‹</button>
                        </div>
                    </div>
                </div>
            </div>

            <div v-if="activeTab === 'info'" class="space-y-4 pb-10">
                <h2 class="text-xl font-black text-slate-800">ğŸ§³ æ—…è¡Œå¿…è¦è³‡è¨Š</h2>
                
                <div class="card bg-red-50 border-l-8 border-red-500">
                    <h3 class="font-black text-red-700 flex items-center gap-2">ğŸ†˜ ç·Šæ€¥æ•‘åŠ©è³‡è¨Š</h3>
                    <div class="mt-3 space-y-2 text-xs font-bold text-red-600">
                        <p>ğŸ“ å ±è­¦: 110 | æ¶ˆé˜²/æ•‘è­·: 119</p>
                        <p>ğŸ“ é§æ—¥ä»£è¡¨è™•(é‚£éœ¸): +81-98-862-2043</p>
                        <p>ğŸš‘ å¤–åœ‹äººé†«ç™‚è«®è©¢: 0570-000-911</p>
                    </div>
                </div>

                <div class="card border-l-8 border-indigo-600">
                    <h3 class="font-black text-slate-700 flex items-center gap-2">ğŸ¨ ä½å®¿é å®šèˆ‡åº§æ¨™</h3>
                    <div class="mt-4 space-y-5">
                        <div @click="goMapCoords(26.4363451, 127.765087)">
                            <p class="text-[10px] font-black text-indigo-600 uppercase">4/14 - 4/15 (1æ™š)</p>
                            <p class="text-sm font-bold text-slate-700 mt-1">æ©ç´æ‘ Maeda é£¯åº—</p>
                            <p class="text-[10px] text-slate-400 mt-1 leading-tight">904-0417 æ²–ç¹©, æ©ç´, Maeda 1460-4</p>
                            <div class="mt-2 flex items-center gap-1 text-[10px] text-sky-600 font-bold">
                                ğŸ“ é»æ“Šé–‹å•Ÿç²¾ç¢ºä½ç½®å°èˆª
                            </div>
                        </div>
                        <div class="pt-4 border-t border-slate-100" @click="goMapCoords(26.1583872, 127.7345247)">
                            <p class="text-[10px] font-black text-indigo-600 uppercase">4/15 - 4/18 (3æ™š)</p>
                            <p class="text-sm font-bold text-slate-700 mt-1">å—åŸå¸‚ Inamine é£¯åº—</p>
                            <p class="text-[10px] text-slate-400 mt-1 leading-tight">901-1204 æ²–ç¹©, å—åŸå¸‚, å¤§é‡Œç¨²å¶ºï¼‘ï¼’ï¼”ï¼™âˆ’ï¼˜</p>
                            <div class="mt-2 flex items-center gap-1 text-[10px] text-sky-600 font-bold">
                                ğŸ“ é»æ“Šé–‹å•Ÿç²¾ç¢ºä½ç½®å°èˆª
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card border-l-8 border-sky-600">
                    <h3 class="font-black text-slate-700">ğŸš— ç§Ÿè»Šåƒè€ƒ</h3>
                    <div class="flex gap-2 mt-3">
                        <button @click="goMapSearch('ORIX Rent a car Naha Airport')" class="flex-1 py-2 bg-sky-50 text-sky-700 text-[10px] font-bold rounded-lg border border-sky-100">ORIX é‚£éœ¸ç©ºæ¸¯</button>
                        <button @click="goMapSearch('OTS Rent a car Rinku Toyosaki')" class="flex-1 py-2 bg-orange-50 text-orange-700 text-[10px] font-bold rounded-lg border border-orange-100">OTS è‡¨ç©ºè±å´</button>
                    </div>
                </div>
            </div>
        </main>

        <div v-if="showPlanModal" class="modal-overlay" @click.self="showPlanModal = false">
            <div class="modal-content">
                <div class="flex justify-between items-center mb-6">
                    <h3 class="text-xl font-black text-slate-800">{{ isEdit ? 'ç·¨è¼¯é …ç›®' : 'æ–°å¢é …ç›®' }}</h3>
                    <button @click="showPlanModal = false" class="text-slate-300">âœ•</button>
                </div>
                <div class="space-y-4">
                    <select v-model="formPlan.category">
                        <option v-for="c in ['æ™¯é»','ä½å®¿','ç¾é£Ÿ','è³¼ç‰©','èˆªç­','å…¶ä»–']" :key="c">{{c}}</option>
                    </select>
                    <input v-model="formPlan.name" placeholder="åç¨±">
                    <input type="time" v-model="formPlan.time">
                    <input v-model="formPlan.openTime" placeholder="æ™‚é–“/å‚™è¨»">
                    <textarea v-model="formPlan.note" rows="4" placeholder="è©³ç´°å…§å®¹..."></textarea>
                    <div class="flex gap-3 pt-4">
                        <button v-if="isEdit" @click="confirmDeletePlan" class="flex-1 py-4 bg-red-50 text-red-500 rounded-2xl font-black uppercase text-xs">åˆªé™¤</button>
                        <button @click="savePlan" class="flex-[2] py-4 bg-sky-800 text-white rounded-2xl font-black shadow-lg">å„²å­˜å„²å­˜</button>
                    </div>
                </div>
            </div>
        </div>

        <nav class="tab-nav">
            <button @click="activeTab = 'plan'" :class="['tab-btn', activeTab === 'plan' ? 'tab-active' : '']">
                <span class="text-2xl">ğŸ“</span><span class="mt-1">è¡Œç¨‹å…§å®¹</span>
            </button>
            <button @click="activeTab = 'food'" :class="['tab-btn', activeTab === 'food' ? 'tab-active' : '']">
                <span class="text-2xl">ğŸ•</span><span class="mt-1">æ²–ç¹©ç¾é£Ÿ</span>
            </button>
            <button @click="activeTab = 'info'" :class="['tab-btn', activeTab === 'info' ? 'tab-active' : '']">
                <span class="text-2xl">ğŸ§³</span><span class="mt-1">é‡è¦è³‡è¨Š</span>
            </button>
        </nav>
    </div>

    <script>
        const { createApp, ref, computed, onMounted } = Vue;
        createApp({
            setup() {
                const activeTab = ref('plan');
                const currentDate = ref('2026-04-14');
                const selectedCat = ref('æ‹‰éºµ');
                const showPlanModal = ref(false);
                const isEdit = ref(false);
                const currentIdx = ref(null);
                const formPlan = ref({});

                const tripDays = [
                    { date: '2026-04-14', week: 'D1', dayNum: '14' },
                    { date: '2026-04-15', week: 'D2', dayNum: '15' },
                    { date: '2026-04-16', week: 'D3', dayNum: '16' },
                    { date: '2026-04-17', week: 'D4', dayNum: '17' },
                    { date: '2026-04-18', week: 'D5', dayNum: '18' }
                ];

                const defaultItineraries = {
                    '2026-04-14': [{ category: 'èˆªç­', name: 'è™èˆª IT728 (KHH â†’ OKA)', time: '15:45', openTime: 'æŠµé” 18:10', note: 'è¨‚ä½ä»£è™Ÿï¼šG23NJLã€F5E9YC\nè¡Œæï¼šæ‰‹æ 10KG / æ‰˜é‹ç¸½è¨ˆ 60KG' }],
                    '2026-04-15': [], '2026-04-16': [], '2026-04-17': [],
                    '2026-04-18': [{ category: 'èˆªç­', name: 'è™èˆª IT289 (OKA â†’ KHH)', time: '14:00', openTime: 'æŠµé” 14:55', note: 'è¨‚ä½ä»£è™Ÿï¼šU1QDSB\nè¡Œæï¼šæ‰‹æ 10KG / æ‰˜é‹ç¸½è¨ˆ 75KG' }]
                };

                const itineraries = ref(defaultItineraries);
                const categories = ['æ‹‰éºµ', 'å®šé£Ÿ', 'ç‰›æ’æˆ–ç‡’è‚‰', 'å°ç”œé»å’–å•¡'];
                
                const foodList = [
                    { name: 'æš–æš®æ‹‰éºµ', cat: 'æ‹‰éºµ', area: 'é‚£éœ¸', desc: 'ä¹å·ç¥¨é¸ç¬¬ä¸€ï¼Œæ¹¯é ­æ¿ƒåšè€Œä¸è†©ã€‚' },
                    { name: 'é€šå ‚æ‹‰éºµ', cat: 'æ‹‰éºµ', area: 'å°ç¥¿', desc: 'ç”·äººéºµèˆ‡å¥³äººéºµï¼Œå¿…åƒé†ƒè˜¿è””ã€‚' },
                    { name: 'ç€å¡”ç‘ªé£¯ç³°', cat: 'å®šé£Ÿ', area: 'ç‰§å¿—', desc: 'ç¾åšè±¬è‚‰è›‹é£¯ç³°ï¼Œæ²–ç¹©å¿…æ’æ—©é¤ã€‚' },
                    { name: 'å¹¸ç¦é¬†é¤…', cat: 'å°ç”œé»å’–å•¡', area: 'ç€¨é•·å³¶', desc: 'èˆ’èŠ™è•¾å£æ„Ÿï¼Œæµ·æ™¯é£›æ©Ÿç¬¬ä¸€æ’ã€‚' },
                    { name: 'ç‰çƒçš„ç‰›', cat: 'ç‰›æ’æˆ–ç‡’è‚‰', area: 'æ©ç´', desc: 'é ‚ç´šç‡’è‚‰ä»£è¡¨ï¼Œè‚‰è³ªæ¥µè‡´ç´°è†©ã€‚' }
                ];

                const filteredFood = computed(() => foodList.filter(f => f.cat === selectedCat.value));
                
                const openAddPlan = () => {
                    isEdit.value = false;
                    formPlan.value = { category:'æ™¯é»', name:'', time:'10:00', openTime:'', note:'' };
                    showPlanModal.value = true;
                };

                const openEditPlan = (item, index) => {
                    isEdit.value = true;
                    currentIdx.value = index;
                    formPlan.value = { ...item };
                    showPlanModal.value = true;
                };

                const savePlan = () => {
                    if(!formPlan.value.name) return;
                    if(isEdit.value) itineraries.value[currentDate.value][currentIdx.value] = { ...formPlan.value };
                    else itineraries.value[currentDate.value].push({ ...formPlan.value });
                    saveToLocal(); showPlanModal.value = false;
                };

                const confirmDeletePlan = () => {
                    if(confirm("ç¢ºå®šåˆªé™¤æ­¤è¡Œç¨‹é …ç›®å—ï¼Ÿ")) {
                        itineraries.value[currentDate.value].splice(currentIdx.value, 1);
                        saveToLocal(); showPlanModal.value = false;
                    }
                };

                const addFoodToPlan = (f) => {
                    itineraries.value[currentDate.value].push({ category:'ç¾é£Ÿ', name: f.name, time:'12:00', openTime:'è¦‹å®˜ç¶²', note: f.desc });
                    saveToLocal(); activeTab.value = 'plan';
                };

                const saveToLocal = () => localStorage.setItem('OKI_FINAL_VER_4', JSON.stringify(itineraries.value));
                
                // åœ°åœ–åŠŸèƒ½ï¼šæœå°‹èˆ‡åº§æ¨™å®šä½
                const goMapSearch = (query) => window.open('https://www.google.com/maps/search/?api=1&query=' + encodeURIComponent(query));
                const goMapCoords = (lat, lng) => window.open(`https://www.google.com/maps/search/?api=1&query=${lat},${lng}`);
                
                const getIcon = (cat) => ({ 'èˆªç­':'âœˆï¸','æ™¯é»':'ğŸ–ï¸','ä½å®¿':'ğŸ¨','ç¾é£Ÿ':'ğŸœ','è³¼ç‰©':'ğŸ›ï¸','å…¶ä»–':'ğŸ“' }[cat] || 'ğŸ“');

                onMounted(() => {
                    const saved = localStorage.getItem('OKI_FINAL_VER_4');
                    if(saved) itineraries.value = JSON.parse(saved);
                });

                return { activeTab, currentDate, selectedCat, categories, tripDays, itineraries, filteredFood, goMapSearch, goMapCoords, addFoodToPlan, getIcon, openAddPlan, openEditPlan, savePlan, confirmDeletePlan, showPlanModal, formPlan, isEdit };
            }
        }).mount('#app');
    </script>
</body>
</html>
